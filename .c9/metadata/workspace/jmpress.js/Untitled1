{"filter":false,"title":"Untitled1","tooltip":"jmpress.js/Untitled1","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":2398,"column":29},"action":"insert","lines":["/*!"," * jmpress.js v0.4.5"," * http://jmpressjs.github.com/jmpress.js"," *"," * A jQuery plugin to build a website on the infinite canvas."," *"," * Copyright 2013 Kyle Robinson Young @shama & Tobias Koppers @sokra"," * Licensed MIT"," * http://www.opensource.org/licenses/mit-license.php"," *"," * Based on the foundation laid by Bartek Szopka @bartaz"," *//*"," * core.js"," * The core of jmpress.js"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\t/**","\t * Set supported prefixes","\t *","\t * @access protected","\t * @return Function to get prefixed property","\t */","\tvar pfx = (function () {","\t\tvar style = document.createElement('dummy').style,","\t\t\tprefixes = 'Webkit Moz O ms Khtml'.split(' '),","\t\t\tmemory = {};","\t\treturn function ( prop ) {","\t\t\tif ( typeof memory[ prop ] === \"undefined\" ) {","\t\t\t\tvar ucProp  = prop.charAt(0).toUpperCase() + prop.substr(1),","\t\t\t\t\tprops   = (prop + ' ' + prefixes.join(ucProp + ' ') + ucProp).split(' ');","\t\t\t\tmemory[ prop ] = null;","\t\t\t\tfor ( var i in props ) {","\t\t\t\t\tif ( style[ props[i] ] !== undefined ) {","\t\t\t\t\t\tmemory[ prop ] = props[i];","\t\t\t\t\t\tbreak;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","\t\t\treturn memory[ prop ];","\t\t};","\t}());","","\t/**","\t * map ex. \"WebkitTransform\" to \"-webkit-transform\"","\t */","\tfunction mapProperty( name ) {","\t\tif(!name) {","\t\t\treturn;","\t\t}","\t\tvar index = 1 + name.substr(1).search(/[A-Z]/);","\t\tvar prefix = name.substr(0, index).toLowerCase();","\t\tvar postfix = name.substr(index).toLowerCase();","\t\treturn \"-\" + prefix + \"-\" + postfix;","\t}","\tfunction addComma( attribute ) {","\t\tif(!attribute) {","\t\t\treturn \"\";","\t\t}","\t\treturn attribute + \",\";","\t}","\t/**","\t * Return an jquery object only if it's not empty","\t */","\tfunction ifNotEmpty(el) {","\t\tif(el.length > 0) {","\t\t\treturn el;","\t\t}","\t\treturn null;","\t}","","\t/**","\t * Default Settings","\t */","\tvar defaults = {","\t\t/* CLASSES */","\t\tstepSelector: '.step'","\t\t,containerClass: ''","\t\t,canvasClass: ''","\t\t,areaClass: ''","\t\t,notSupportedClass: 'not-supported'","","\t\t/* CONFIG */","\t\t,fullscreen: true","","\t\t/* ANIMATION */","\t\t,animation: {","\t\t\ttransformOrigin: 'top left'","\t\t\t,transitionProperty: addComma(mapProperty(pfx('transform'))) + addComma(mapProperty(pfx('perspective'))) + 'opacity'","\t\t\t,transitionDuration: '1s'","\t\t\t,transitionDelay: '500ms'","\t\t\t,transitionTimingFunction: 'ease-in-out'","\t\t\t,transformStyle: \"preserve-3d\"","\t\t}","\t\t,transitionDuration: 1500","\t};","\tvar callbacks = {","\t\t'beforeChange': 1","\t\t,'beforeInitStep': 1","\t\t,'initStep': 1","\t\t,'beforeInit': 1","\t\t,'afterInit': 1","\t\t,'beforeDeinit': 1","\t\t,'afterDeinit': 1","\t\t,'applyStep': 1","\t\t,'unapplyStep': 1","\t\t,'setInactive': 1","\t\t,'beforeActive': 1","\t\t,'setActive': 1","\t\t,'selectInitialStep': 1","\t\t,'selectPrev': 1","\t\t,'selectNext': 1","\t\t,'selectHome': 1","\t\t,'selectEnd': 1","\t\t,'idle': 1","\t\t,'applyTarget': 1","\t};","\tfor(var callbackName in callbacks) {","\t\tdefaults[callbackName] = [];","\t}","","","\t/**","\t * Initialize jmpress","\t */","\tfunction init( args ) {","\t\targs = $.extend(true, {}, args || {});","","\t\t// accept functions and arrays of functions as callbacks","\t\tvar callbackArgs = {};","\t\tvar callbackName = null;","\t\tfor (callbackName in callbacks) {","\t\t\tcallbackArgs[callbackName] = $.isFunction( args[callbackName] ) ?","\t\t\t\t[ args[callbackName] ] :","\t\t\t\targs[callbackName];","\t\t\targs[callbackName] = [];","\t\t}","","\t\t// MERGE SETTINGS","\t\tvar settings = $.extend(true, {}, defaults, args);","","\t\tfor (callbackName in callbacks) {","\t\t\tif (callbackArgs[callbackName]) {","\t\t\t\tArray.prototype.push.apply(settings[callbackName], callbackArgs[callbackName]);","\t\t\t}","\t\t}","","\t\t/*** MEMBER VARS ***/","","\t\tvar jmpress = $( this )","\t\t\t,container = null","\t\t\t,area = null","\t\t\t,oldStyle = {","\t\t\t\tcontainer: \"\"","\t\t\t\t,area: \"\"","\t\t\t}","\t\t\t,canvas = null","\t\t\t,current = null","\t\t\t,active = false","\t\t\t,activeSubstep = null","\t\t\t,activeDelegated = false;","","","\t\t/*** MEMBER FUNCTIONS ***/","\t\t// functions have to be called with this","","\t\t/**","\t\t * Init a single step","\t\t *","\t\t * @param element the element of the step","\t\t * @param idx number of step","\t\t */","\t\tfunction doStepInit( element, idx ) {","\t\t\tvar data = dataset( element );","\t\t\tvar step = {","\t\t\t\toldStyle: $(element).attr(\"style\") || \"\"","\t\t\t};","","\t\t\tvar callbackData = {","\t\t\t\tdata: data","\t\t\t\t,stepData: step","\t\t\t};","\t\t\tcallCallback.call(this, 'beforeInitStep', $(element), callbackData);","\t\t\tstep.delegate = data.delegate;","\t\t\tcallCallback.call(this, 'initStep', $(element), callbackData);","","\t\t\t$(element).data('stepData', step);","","\t\t\tif ( !$(element).attr('id') ) {","\t\t\t\t$(element).attr('id', 'step-' + (idx + 1));","\t\t\t}","","\t\t\tcallCallback.call(this, 'applyStep', $(element), callbackData);","\t\t}","\t\t/**","\t\t * Deinit a single step","\t\t *","\t\t * @param element the element of the step","\t\t */","\t\tfunction doStepDeinit( element ) {","\t\t\tvar stepData = $(element).data('stepData');","","\t\t\t$(element).attr(\"style\", stepData.oldStyle);","","\t\t\tcallCallback.call(this, 'unapplyStep', $(element), {","\t\t\t\tstepData: stepData","\t\t\t});","\t\t}","\t\t/**","\t\t * Reapplies stepData to the element","\t\t *","\t\t * @param element","\t\t */","\t\tfunction doStepReapply( element ) {","\t\t\tcallCallback.call(this, 'unapplyStep', $(element), {","\t\t\t\tstepData: element.data(\"stepData\")","\t\t\t});","","\t\t\tcallCallback.call(this, 'applyStep', $(element), {","\t\t\t\tstepData: element.data(\"stepData\")","\t\t\t});","\t\t}","\t\t/**","\t\t * Completly deinit jmpress","\t\t *","\t\t */","\t\tfunction deinit() {","\t\t\tif ( active ) {","\t\t\t\tcallCallback.call(this, 'setInactive', active, {","\t\t\t\t\tstepData: $(active).data('stepData')","\t\t\t\t\t,reason: \"deinit\"","\t\t\t\t} );","\t\t\t}","\t\t\tif (current.jmpressClass) {","\t\t\t\t$(jmpress).removeClass(current.jmpressClass);","\t\t\t}","","\t\t\tcallCallback.call(this, 'beforeDeinit', $(this), {});","","\t\t\t$(settings.stepSelector, jmpress).each(function( idx ) {","\t\t\t\tdoStepDeinit.call(jmpress, this );","\t\t\t});","","\t\t\tcontainer.attr(\"style\", oldStyle.container);","\t\t\tif(settings.fullscreen) {","\t\t\t\t$(\"html\").attr(\"style\", \"\");","\t\t\t}","\t\t\tarea.attr(\"style\", oldStyle.area);","\t\t\t$(canvas).children().each(function() {","\t\t\t\tjmpress.append( $( this ) );","\t\t\t});","\t\t\tif( settings.fullscreen ) {","\t\t\t\tcanvas.remove();","\t\t\t} else {","\t\t\t\tcanvas.remove();","\t\t\t\tarea.remove();","\t\t\t}","","\t\t\tcallCallback.call(this, 'afterDeinit', $(this), {});","","\t\t\t$(jmpress).data(\"jmpressmethods\", false);","\t\t}","\t\t/**","\t\t * Call a callback","\t\t *","\t\t * @param callbackName String callback which should be called","\t\t * @param element some arguments to the callback","\t\t * @param eventData","\t\t */","\t\tfunction callCallback( callbackName, element, eventData ) {","\t\t\teventData.settings = settings;","\t\t\teventData.current = current;","\t\t\teventData.container = container;","\t\t\teventData.parents = element ? getStepParents(element) : null;","\t\t\teventData.current = current;","\t\t\teventData.jmpress = this;","\t\t\tvar result = {};","\t\t\t$.each( settings[callbackName], function(idx, callback) {","\t\t\t\tresult.value = callback.call( jmpress, element, eventData ) || result.value;","\t\t\t});","\t\t\treturn result.value;","\t\t}","\t\t/**","\t\t *","\t\t */","\t\tfunction getStepParents( el ) {","\t\t\treturn $(el).parentsUntil(jmpress).not(jmpress).filter(settings.stepSelector);","\t\t}","\t\t/**","\t\t * Reselect the active step","\t\t *","\t\t * @param String type reason of reselecting step","\t\t */","\t\tfunction reselect( type ) {","\t\t\treturn select( { step: active, substep: activeSubstep }, type);","\t\t}","\t\t/**","\t\t * Select a given step","\t\t *","\t\t * @param el element to select","\t\t * @param type reason of changing step","\t\t * @return Object element selected","\t\t */","\t\tfunction select( el, type ) {","\t\t\tvar substep;","\t\t\tif ( $.isPlainObject( el ) ) {","\t\t\t\tsubstep = el.substep;","\t\t\t\tel = el.step;","\t\t\t}","\t\t\tif ( typeof el === 'string') {","\t\t\t\tel = jmpress.find( el ).first();","\t\t\t}","\t\t\tif ( !el || !$(el).data('stepData') ) {","\t\t\t\treturn false;","\t\t\t}","","\t\t\tscrollFix.call(this);","","\t\t\tvar step = $(el).data('stepData');","","\t\t\tvar cancelSelect = false;","\t\t\tcallCallback.call(this, \"beforeChange\", el, {","\t\t\t\tstepData: step","\t\t\t\t,reason: type","\t\t\t\t,cancel: function() {","\t\t\t\t\tcancelSelect = true;","\t\t\t\t}","\t\t\t});","\t\t\tif (cancelSelect) {","\t\t\t\treturn undefined;","\t\t\t}","","\t\t\tvar target = {};","","\t\t\tvar delegated = el;","\t\t\tif($(el).data(\"stepData\").delegate) {","\t\t\t\tdelegated = ifNotEmpty($(el).parentsUntil(jmpress).filter(settings.stepSelector).filter(step.delegate)) ||","\t\t\t\t\tifNotEmpty($(el).near(step.delegate)) ||","\t\t\t\t\tifNotEmpty($(el).near(step.delegate, true)) ||","\t\t\t\t\tifNotEmpty($(step.delegate, jmpress));","\t\t\t\tif(delegated) {","\t\t\t\t\tstep = delegated.data(\"stepData\");","\t\t\t\t} else {","\t\t\t\t\t// Do not delegate if expression not found","\t\t\t\t\tdelegated = el;","\t\t\t\t}","\t\t\t}","\t\t\tif ( activeDelegated ) {","\t\t\t\tcallCallback.call(this, 'setInactive', activeDelegated, {","\t\t\t\t\tstepData: $(activeDelegated).data('stepData')","\t\t\t\t\t,delegatedFrom: active","\t\t\t\t\t,reason: type","\t\t\t\t\t,target: target","\t\t\t\t\t,nextStep: delegated","\t\t\t\t\t,nextSubstep: substep","\t\t\t\t\t,nextStepData: step","\t\t\t\t} );","\t\t\t}","\t\t\tvar callbackData = {","\t\t\t\tstepData: step","\t\t\t\t,delegatedFrom: el","\t\t\t\t,reason: type","\t\t\t\t,target: target","\t\t\t\t,substep: substep","\t\t\t\t,prevStep: activeDelegated","\t\t\t\t,prevSubstep: activeSubstep","\t\t\t\t,prevStepData: activeDelegated && $(activeDelegated).data('stepData')","\t\t\t};","\t\t\tcallCallback.call(this, 'beforeActive', delegated, callbackData);","\t\t\tcallCallback.call(this, 'setActive', delegated, callbackData);","","\t\t\t// Set on step class on root element","\t\t\tif (current.jmpressClass) {","\t\t\t\t$(jmpress).removeClass(current.jmpressClass);","\t\t\t}","\t\t\t$(jmpress).addClass(current.jmpressClass = 'step-' + $(delegated).attr('id') );","\t\t\tif (current.jmpressDelegatedClass) {","\t\t\t\t$(jmpress).removeClass(current.jmpressDelegatedClass);","\t\t\t}","\t\t\t$(jmpress).addClass(current.jmpressDelegatedClass = 'delegating-step-' + $(el).attr('id') );","","\t\t\tcallCallback.call(this, \"applyTarget\", delegated, $.extend({","\t\t\t\tcanvas: canvas","\t\t\t\t,area: area","\t\t\t\t,beforeActive: activeDelegated","\t\t\t}, callbackData));","","\t\t\tactive = el;","\t\t\tactiveSubstep = callbackData.substep;","\t\t\tactiveDelegated = delegated;","","\t\t\tif(current.idleTimeout) {","\t\t\t\tclearTimeout(current.idleTimeout);","\t\t\t}","\t\t\tcurrent.idleTimeout = setTimeout(function() {","\t\t\t\tcallCallback.call(this, 'idle', delegated, callbackData);","\t\t\t}, Math.max(1, settings.transitionDuration - 100));","","\t\t\treturn delegated;","\t\t}","\t\t/**","\t\t * This should fix ANY kind of buggy scrolling","\t\t */","\t\tfunction scrollFix() {","\t\t\t(function fix() {","\t\t\t\tif ($(container)[0].tagName === \"BODY\") {","\t\t\t\t\ttry {","\t\t\t\t\t\twindow.scrollTo(0, 0);","\t\t\t\t\t} catch(e) {}","\t\t\t\t}","\t\t\t\t$(container).scrollTop(0);","\t\t\t\t$(container).scrollLeft(0);","\t\t\t\tfunction check() {","\t\t\t\t\tif ($(container).scrollTop() !== 0 ||","\t\t\t\t\t\t$(container).scrollLeft() !== 0) {","\t\t\t\t\t\t\tfix();","\t\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tsetTimeout(check, 1);","\t\t\t\tsetTimeout(check, 10);","\t\t\t\tsetTimeout(check, 100);","\t\t\t\tsetTimeout(check, 200);","\t\t\t\tsetTimeout(check, 400);","\t\t\t}());","\t\t}","\t\t/**","\t\t * Alias for select","\t\t */","\t\tfunction goTo( el ) {","\t\t\treturn select.call(this, el, \"jump\" );","\t\t}","\t\t/**","\t\t * Goto Next Slide","\t\t *","\t\t * @return Object newly active slide","\t\t */","\t\tfunction next() {","\t\t\treturn select.call(this, callCallback.call(this, 'selectNext', active, {","\t\t\t\tstepData: $(active).data('stepData')","\t\t\t\t,substep: activeSubstep","\t\t\t}), \"next\" );","\t\t}","\t\t/**","\t\t * Goto Previous Slide","\t\t *","\t\t * @return Object newly active slide","\t\t */","\t\tfunction prev() {","\t\t\treturn select.call(this, callCallback.call(this, 'selectPrev', active, {","\t\t\t\tstepData: $(active).data('stepData')","\t\t\t\t,substep: activeSubstep","\t\t\t}), \"prev\" );","\t\t}","\t\t/**","\t\t * Goto First Slide","\t\t *","\t\t * @return Object newly active slide","\t\t */","\t\tfunction home() {","\t\t\treturn select.call(this, callCallback.call(this, 'selectHome', active, {","\t\t\t\tstepData: $(active).data('stepData')","\t\t\t}), \"home\" );","\t\t}","\t\t/**","\t\t * Goto Last Slide","\t\t *","\t\t * @return Object newly active slide","\t\t */","\t\tfunction end() {","\t\t\treturn select.call(this,   callCallback.call(this, 'selectEnd', active, {","\t\t\t\tstepData: $(active).data('stepData')","\t\t\t}), \"end\" );","\t\t}","\t\t/**","\t\t * Manipulate the canvas","\t\t *","\t\t * @param props","\t\t * @return Object","\t\t */","\t\tfunction canvasMod( props ) {","\t\t\tcss(canvas, props || {});","\t\t\treturn $(canvas);","\t\t}","\t\t/**","\t\t * Return current step","\t\t *","\t\t * @return Object","\t\t */","\t\tfunction getActive() {","\t\t\treturn activeDelegated && $(activeDelegated);","\t\t}","\t\t/**","\t\t * fire a callback","\t\t *","\t\t * @param callbackName","\t\t * @param element","\t\t * @param eventData","\t\t * @return void","\t\t */","\t\tfunction fire( callbackName, element, eventData ) {","\t\t\tif( !callbacks[callbackName] ) {","\t\t\t\t$.error( \"callback \" + callbackName + \" is not registered.\" );","\t\t\t} else {","\t\t\t\treturn callCallback.call(this, callbackName, element, eventData);","\t\t\t}","\t\t}","","\t\t/**","\t\t * PUBLIC METHODS LIST","\t\t */","\t\tjmpress.data(\"jmpressmethods\", {","\t\t\tselect: select","\t\t\t,reselect: reselect","\t\t\t,scrollFix: scrollFix","\t\t\t,goTo: goTo","\t\t\t,next: next","\t\t\t,prev: prev","\t\t\t,home: home","\t\t\t,end: end","\t\t\t,canvas: canvasMod","\t\t\t,container: function() { return container; }","\t\t\t,settings: function() { return settings; }","\t\t\t,active: getActive","\t\t\t,current: function() { return current; }","\t\t\t,fire: fire","\t\t\t,init: function(step) {","\t\t\t\tdoStepInit.call(this, $(step), current.nextIdNumber++);","\t\t\t}","\t\t\t,deinit: function(step) {","\t\t\t\tif(step) {","\t\t\t\t\tdoStepDeinit.call(this, $(step));","\t\t\t\t} else {","\t\t\t\t\tdeinit.call(this);","\t\t\t\t}","\t\t\t}","\t\t\t,reapply: doStepReapply","\t\t});","","\t\t/**","\t\t * Check for support","\t\t * This will be removed in near future, when support is coming","\t\t *","\t\t * @access protected","\t\t * @return void","\t\t */","\t\tfunction checkSupport() {","\t\t\tvar ua = navigator.userAgent.toLowerCase();","\t\t\treturn (ua.search(/(iphone)|(ipod)|(android)/) === -1) || (ua.search(/(chrome)/) !== -1);","\t\t}","","\t\t// BEGIN INIT","","\t\t// CHECK FOR SUPPORT","\t\tif (checkSupport() === false) {","\t\t\tif (settings.notSupportedClass) {","\t\t\t\tjmpress.addClass(settings.notSupportedClass);","\t\t\t}","\t\t\treturn;","\t\t} else {","\t\t\tif (settings.notSupportedClass) {","\t\t\t\tjmpress.removeClass(settings.notSupportedClass);","\t\t\t}","\t\t}","","\t\t// grabbing all steps","\t\tvar steps = $(settings.stepSelector, jmpress);","","\t\t// GERNERAL INIT OF FRAME","\t\tcontainer = jmpress;","\t\tarea = $('<div />');","\t\tcanvas = $('<div />');","\t\t$(jmpress).children().filter(steps).each(function() {","\t\t\tcanvas.append( $( this ) );","\t\t});","\t\tif(settings.fullscreen) {","\t\t\tcontainer = $('body');","\t\t\t$(\"html\").css({","\t\t\t\toverflow: 'hidden'","\t\t\t});","\t\t\tarea = jmpress;","\t\t}","\t\toldStyle.area = area.attr(\"style\") || \"\";","\t\toldStyle.container = container.attr(\"style\") || \"\";","\t\tif(settings.fullscreen) {","\t\t\tcontainer.css({","\t\t\t\theight: '100%'","\t\t\t});","\t\t\tjmpress.append( canvas );","\t\t} else {","\t\t\tcontainer.css({","\t\t\t\tposition: \"relative\"","\t\t\t});","\t\t\tarea.append( canvas );","\t\t\tjmpress.append( area );","\t\t}","","\t\t$(container).addClass(settings.containerClass);","\t\t$(area).addClass(settings.areaClass);","\t\t$(canvas).addClass(settings.canvasClass);","","\t\tdocument.documentElement.style.height = \"100%\";","\t\tcontainer.css({","\t\t\toverflow: 'hidden'","\t\t});","","\t\tvar props = {","\t\t\tposition: \"absolute\"","\t\t\t,transitionDuration: '0s'","\t\t};","\t\tprops = $.extend({}, settings.animation, props);","\t\tcss(area, props);","\t\tcss(area, {","\t\t\ttop: '50%'","\t\t\t,left: '50%'","\t\t\t,perspective: '1000px'","\t\t});","\t\tcss(canvas, props);","","\t\tcurrent = {};","","\t\tcallCallback.call(this, 'beforeInit', null, {});","","\t\t// INITIALIZE EACH STEP","\t\tsteps.each(function( idx ) {","\t\t\tdoStepInit.call(jmpress, this, idx );","\t\t});","\t\tcurrent.nextIdNumber = steps.length;","","\t\tcallCallback.call(this, 'afterInit', null, {});","","\t\t// START","\t\tselect.call(this,  callCallback.call(this, 'selectInitialStep', \"init\", {}) );","","\t\tif (settings.initClass) {","\t\t\t$(steps).removeClass(settings.initClass);","\t\t}","\t}","\t/**","\t * Return default settings","\t *","\t * @return Object","\t */","\tfunction getDefaults() {","\t\treturn defaults;","\t}","\t/**","\t * Register a callback or a jmpress function","\t *","\t * @access public","\t * @param name String the name of the callback or function","\t * @param func Function? the function to be added","\t */","\tfunction register(name, func) {","\t\tif( $.isFunction(func) ) {","\t\t\tif( methods[name] ) {","\t\t\t\t$.error( \"function \" + name + \" is already registered.\" );","\t\t\t} else {","\t\t\t\tmethods[name] = func;","\t\t\t}","\t\t} else {","\t\t\tif( callbacks[name] ) {","\t\t\t\t$.error( \"callback \" + name + \" is already registered.\" );","\t\t\t} else {","\t\t\t\tcallbacks[name] = 1;","\t\t\t\tdefaults[name] = [];","\t\t\t}","\t\t}","\t}","\t/**","\t * Set CSS on element w/ prefixes","\t *","\t * @return Object element which properties were set","\t *","\t * TODO: Consider bypassing pfx and blindly set as jQuery","\t * already checks for support","\t */","\tfunction css( el, props ) {","\t\tvar key, pkey, cssObj = {};","\t\tfor ( key in props ) {","\t\t\tif ( props.hasOwnProperty(key) ) {","\t\t\t\tpkey = pfx(key);","\t\t\t\tif ( pkey !== null ) {","\t\t\t\t\tcssObj[pkey] = props[key];","\t\t\t\t}","\t\t\t}","\t\t}","\t\t$(el).css(cssObj);","\t\treturn el;","\t}","\t/**","\t * Return dataset for element","\t *","\t * @param el element","\t * @return Object","\t */","\tfunction dataset( el ) {","\t\tif ( $(el)[0].dataset ) {","\t\t\treturn $.extend({}, $(el)[0].dataset);","\t\t}","\t\tfunction toCamelcase( str ) {","\t\t\tstr = str.split( '-' );","\t\t\tfor( var i = 1; i < str.length; i++ ) {","\t\t\t\tstr[i] = str[i].substr(0, 1).toUpperCase() + str[i].substr(1);","\t\t\t}","\t\t\treturn str.join( '' );","\t\t}","\t\tvar returnDataset = {};","\t\tvar attrs = $(el)[0].attributes;","\t\t$.each(attrs, function ( idx, attr ) {","\t\t\tif ( attr.nodeName.substr(0, 5) === \"data-\" ) {","\t\t\t\treturnDataset[ toCamelcase(attr.nodeName.substr(5)) ] = attr.nodeValue;","\t\t\t}","\t\t});","\t\treturn returnDataset;","\t}","\t/**","\t * Returns true, if jmpress is initialized","\t *","\t * @return bool","\t */","\tfunction initialized() {","\t\treturn !!$(this).data(\"jmpressmethods\");","\t}","","","\t/**","\t * PUBLIC STATIC METHODS LIST","\t */","\tvar methods = {","\t\tinit: init","\t\t,initialized: initialized","\t\t,deinit: function() {}","\t\t,css: css","\t\t,pfx: pfx","\t\t,defaults: getDefaults","\t\t,register: register","\t\t,dataset: dataset","\t};","","\t/**","\t * $.jmpress()","\t */","\t$.fn.jmpress = function( method ) {","\t\tfunction f() {","\t\t\tvar jmpressmethods = $(this).data(\"jmpressmethods\");","\t\t\tif ( jmpressmethods && jmpressmethods[method] ) {","\t\t\t\treturn jmpressmethods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));","\t\t\t} else if ( methods[method] ) {","\t\t\t\treturn methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));","\t\t\t} else if ( callbacks[method] && jmpressmethods ) {","\t\t\t\tvar settings = jmpressmethods.settings();","\t\t\t\tvar func = Array.prototype.slice.call( arguments, 1 )[0];","\t\t\t\tif ($.isFunction( func )) {","\t\t\t\t\tsettings[method] = settings[method] || [];","\t\t\t\t\tsettings[method].push(func);","\t\t\t\t}","\t\t\t} else if ( typeof method === 'object' || ! method ) {","\t\t\t\treturn init.apply( this, arguments );","\t\t\t} else {","\t\t\t\t$.error( 'Method ' +  method + ' does not exist on jQuery.jmpress' );","\t\t\t}","\t\t\t// to allow chaining","\t\t\treturn this;","\t\t}","\t\tvar args = arguments;","\t\tvar result;","\t\t$(this).each(function(idx, element) {","\t\t\tresult = f.apply(element, args);","\t\t});","\t\treturn result;","\t};","\t$.extend({","\t\tjmpress: function( method ) {","\t\t\tif ( methods[method] ) {","\t\t\t\treturn methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));","\t\t\t} else if ( callbacks[method] ) {","\t\t\t\t// plugin interface","\t\t\t\tvar func = Array.prototype.slice.call( arguments, 1 )[0];","\t\t\t\tif ($.isFunction( func )) {","\t\t\t\t\tdefaults[method].push(func);","\t\t\t\t} else {","\t\t\t\t\t$.error( 'Second parameter should be a function: $.jmpress( callbackName, callbackFunction )' );","\t\t\t\t}","\t\t\t} else {","\t\t\t\t$.error( 'Method ' +  method + ' does not exist on jQuery.jmpress' );","\t\t\t}","\t\t}","\t});","","}(jQuery, document, window));","","/*"," * near.js"," * Find steps near each other"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\t// add near( selector, backwards = false) to jquery","","","\tfunction checkAndGo( elements, func, selector, backwards ) {","\t\tvar next;","\t\telements.each(function(idx, element) {","\t\t\tif(backwards) {","\t\t\t\tnext = func(element, selector, backwards);","\t\t\t\tif (next) {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","\t\t\tif( $(element).is(selector) ) {","\t\t\t\tnext = element;","\t\t\t\treturn false;","\t\t\t}","\t\t\tif(!backwards) {","\t\t\t\tnext = func(element, selector, backwards);","\t\t\t\tif (next) {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","\t\t});","\t\treturn next;","\t}","\tfunction findNextInChildren(item, selector, backwards) {","\t\tvar children = $(item).children();","\t\tif(backwards) {","\t\t\tchildren = $(children.get().reverse());","\t\t}","\t\treturn checkAndGo( children, findNextInChildren, selector, backwards );","\t}","\tfunction findNextInSiblings(item, selector, backwards) {","\t\treturn checkAndGo(","\t\t\t$(item)[backwards ? \"prevAll\" : \"nextAll\"](),","\t\t\tfindNextInChildren, selector, backwards );","\t}","\tfunction findNextInParents(item, selector, backwards) {","\t\tvar next;","\t\tvar parents = $(item).parents();","\t\tparents = $(parents.get());","\t\t$.each(parents.get(), function(idx, element) {","\t\t\tif( backwards && $(element).is(selector) ) {","\t\t\t\tnext = element;","\t\t\t\treturn false;","\t\t\t}","\t\t\tnext = findNextInSiblings(element, selector, backwards);","\t\t\tif(next) {","\t\t\t\treturn false;","\t\t\t}","\t\t});","\t\treturn next;","\t}","","\t$.fn.near = function( selector, backwards ) {","\t\tvar array = [];","\t\t$(this).each(function(idx, element) {","\t\t\tvar near = (backwards ?","\t\t\t\t\tfalse :","\t\t\t\t\tfindNextInChildren( element, selector, backwards )) ||","\t\t\t\tfindNextInSiblings( element, selector, backwards ) ||","\t\t\t\tfindNextInParents( element, selector, backwards );","\t\t\tif( near ) {","\t\t\t\tarray.push(near);","\t\t\t}","\t\t});","\t\treturn $(array);","\t};","}(jQuery, document, window));","/*"," * transform.js"," * The engine that powers the transforms or falls back to other methods"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\t/* FUNCTIONS */","\tfunction toCssNumber(number) {","\t\treturn (Math.round(10000*number)/10000)+\"\";","\t}","","\t/**","\t * 3D and 2D engines","\t */","\tvar engines = {","\t\t3: {","\t\t\ttransform: function( el, data ) {","\t\t\t\tvar transform = 'translate(-50%,-50%)';","\t\t\t\t$.each(data, function(idx, item) {","\t\t\t\t\tvar coord = [\"X\", \"Y\", \"Z\"];","\t\t\t\t\tvar i;","\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]","\t\t\t\t\t\ttransform += \" translate3d(\" + toCssNumber(item[1] || 0) + \"px,\" + toCssNumber(item[2] || 0) + \"px,\" + toCssNumber(item[3] || 0) + \"px)\";","\t\t\t\t\t} else if(item[0] === \"rotate\") {","\t\t\t\t\t\tvar order = item[4] ? [1, 2, 3] : [3, 2, 1];","\t\t\t\t\t\tfor(i = 0; i < 3; i++) {","\t\t\t\t\t\t\ttransform += \" rotate\" + coord[order[i]-1] + \"(\" + toCssNumber(item[order[i]] || 0) + \"deg)\";","\t\t\t\t\t\t}","\t\t\t\t\t} else if(item[0] === \"scale\") {","\t\t\t\t\t\tfor(i = 0; i < 3; i++) {","\t\t\t\t\t\t\ttransform += \" scale\" + coord[i] + \"(\" + toCssNumber(item[i+1] || 1) + \")\";","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t});","\t\t\t\t$.jmpress(\"css\", el, $.extend({}, { transform: transform }));","\t\t\t}","\t\t}","\t\t,2: {","\t\t\ttransform: function( el, data ) {","\t\t\t\tvar transform = 'translate(-50%,-50%)';","\t\t\t\t$.each(data, function(idx, item) {","\t\t\t\t\tvar coord = [\"X\", \"Y\"];","\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]","\t\t\t\t\t\ttransform += \" translate(\" + toCssNumber(item[1] || 0) + \"px,\" + toCssNumber(item[2] || 0) + \"px)\";","\t\t\t\t\t} else if(item[0] === \"rotate\") {","\t\t\t\t\t\ttransform += \" rotate(\" + toCssNumber(item[3] || 0) + \"deg)\";","\t\t\t\t\t} else if(item[0] === \"scale\") {","\t\t\t\t\t\tfor(var i = 0; i < 2; i++) {","\t\t\t\t\t\t\ttransform += \" scale\" + coord[i] + \"(\" + toCssNumber(item[i+1] || 1) + \")\";","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t});","\t\t\t\t$.jmpress(\"css\", el, $.extend({}, { transform: transform }));","\t\t\t}","\t\t}","\t\t,1: {","\t\t\t// CHECK IF SUPPORT IS REALLY NEEDED?","\t\t\t// this not even work without scaling...","\t\t\t// it may better to display the normal view","\t\t\ttransform: function( el, data ) {","\t\t\t\tvar anitarget = { top: 0, left: 0 };","\t\t\t\t$.each(data, function(idx, item) {","\t\t\t\t\tvar coord = [\"X\", \"Y\"];","\t\t\t\t\tif(item[0] === \"translate\") { // [\"translate\", x, y, z]","\t\t\t\t\t\tanitarget.left = Math.round(item[1] || 0) + \"px\";","\t\t\t\t\t\tanitarget.top = Math.round(item[2] || 0) + \"px\";","\t\t\t\t\t}","\t\t\t\t});","\t\t\t\tel.animate(anitarget, 1000); // TODO: Use animation duration","\t\t\t}","\t\t}","\t};","","\t/**","\t * Engine to power cross-browser translate, scale and rotate.","\t */","\tvar engine = (function() {","\t\tif ($.jmpress(\"pfx\", \"perspective\")) {","\t\t\treturn engines[3];","\t\t} else if ($.jmpress(\"pfx\", \"transform\")) {","\t\t\treturn engines[2];","\t\t} else {","\t\t\t// CHECK IF SUPPORT IS REALLY NEEDED?","\t\t\treturn engines[1];","\t\t}","\t}());","","\t$.jmpress(\"defaults\").reasonableAnimation = {};","\t$.jmpress(\"initStep\", function( step, eventData ) {","\t\tvar data = eventData.data;","\t\tvar stepData = eventData.stepData;","\t\tvar pf = parseFloat;","\t\t$.extend(stepData, {","\t\t\tx: pf(data.x) || 0","\t\t\t,y: pf(data.y) || 0","\t\t\t,z: pf(data.z) || 0","\t\t\t,r: pf(data.r) || 0","\t\t\t,phi: pf(data.phi) || 0","\t\t\t,rotate: pf(data.rotate) || 0","\t\t\t,rotateX: pf(data.rotateX) || 0","\t\t\t,rotateY: pf(data.rotateY) || 0","\t\t\t,rotateZ: pf(data.rotateZ) || 0","\t\t\t,revertRotate: false","\t\t\t,scale: pf(data.scale) || 1","\t\t\t,scaleX: pf(data.scaleX) || false","\t\t\t,scaleY: pf(data.scaleY) || false","\t\t\t,scaleZ: pf(data.scaleZ) || 1","\t\t});","\t});","\t$.jmpress(\"afterInit\", function( nil, eventData ) {","\t\tvar stepSelector = eventData.settings.stepSelector,","\t\t\tcurrent = eventData.current;","\t\tcurrent.perspectiveScale = 1;","\t\tcurrent.maxNestedDepth = 0;","\t\tvar nestedSteps = $(eventData.jmpress).find(stepSelector).children(stepSelector);","\t\twhile(nestedSteps.length) {","\t\t\tcurrent.maxNestedDepth++;","\t\t\tnestedSteps = nestedSteps.children(stepSelector);","\t\t}","\t});","\t$.jmpress(\"applyStep\", function( step, eventData ) {","\t\t$.jmpress(\"css\", $(step), {","\t\t\tposition: \"absolute\"","\t\t\t,transformStyle: \"preserve-3d\"","\t\t});","\t\tif ( eventData.parents.length > 0 ) {","\t\t\t$.jmpress(\"css\", $(step), {","\t\t\t\ttop: \"50%\"","\t\t\t\t,left: \"50%\"","\t\t\t});","\t\t}","\t\tvar sd = eventData.stepData;","\t\tvar transform = [","\t\t\t[\"translate\",","\t\t\t\tsd.x || (sd.r * Math.sin(sd.phi*Math.PI/180)),","\t\t\t\tsd.y || (-sd.r * Math.cos(sd.phi*Math.PI/180)),","\t\t\t\tsd.z],","\t\t\t[\"rotate\",","\t\t\t\tsd.rotateX,","\t\t\t\tsd.rotateY,","\t\t\t\tsd.rotateZ || sd.rotate,","\t\t\t\ttrue],","\t\t\t[\"scale\",","\t\t\t\tsd.scaleX || sd.scale,","\t\t\t\tsd.scaleY || sd.scale,","\t\t\t\tsd.scaleZ || sd.scale]","\t\t];","\t\tengine.transform( step, transform );","\t});","\t$.jmpress(\"setActive\", function( element, eventData ) {","\t\tvar target = eventData.target;","\t\tvar step = eventData.stepData;","\t\tvar tf = target.transform = [];","\t\ttarget.perspectiveScale = 1;","","\t\tfor(var i = eventData.current.maxNestedDepth; i > (eventData.parents.length || 0); i--) {","\t\t\ttf.push([\"scale\"], [\"rotate\"], [\"translate\"]);","\t\t}","","\t\ttf.push([\"scale\",","\t\t\t1 / (step.scaleX || step.scale),","\t\t\t1 / (step.scaleY || step.scale),","\t\t\t1 / (step.scaleZ)]);","\t\ttf.push([\"rotate\",","\t\t\t-step.rotateX,","\t\t\t-step.rotateY,","\t\t\t-(step.rotateZ || step.rotate)]);","\t\ttf.push([\"translate\",","\t\t\t-(step.x || (step.r * Math.sin(step.phi*Math.PI/180))),","\t\t\t-(step.y || (-step.r * Math.cos(step.phi*Math.PI/180))),","\t\t\t-step.z]);","\t\ttarget.perspectiveScale *= (step.scaleX || step.scale);","","\t\t$.each(eventData.parents, function(idx, element) {","\t\t\tvar step = $(element).data(\"stepData\");","\t\t\ttf.push([\"scale\",","\t\t\t\t1 / (step.scaleX || step.scale),","\t\t\t\t1 / (step.scaleY || step.scale),","\t\t\t\t1 / (step.scaleZ)]);","\t\t\ttf.push([\"rotate\",","\t\t\t\t-step.rotateX,","\t\t\t\t-step.rotateY,","\t\t\t\t-(step.rotateZ || step.rotate)]);","\t\t\ttf.push([\"translate\",","\t\t\t\t-(step.x || (step.r * Math.sin(step.phi*Math.PI/180))),","\t\t\t\t-(step.y || (-step.r * Math.cos(step.phi*Math.PI/180))),","\t\t\t\t-step.z]);","\t\t\ttarget.perspectiveScale *= (step.scaleX || step.scale);","\t\t});","","\t\t$.each(tf, function(idx, item) {","\t\t\tif(item[0] !== \"rotate\") {","\t\t\t\treturn;","\t\t\t}","\t\t\tfunction lowRotate(name) {","\t\t\t\tif(eventData.current[\"rotate\"+name+\"-\"+idx] === undefined) {","\t\t\t\t\teventData.current[\"rotate\"+name+\"-\"+idx] = item[name] || 0;","\t\t\t\t}","\t\t\t\tvar cur = eventData.current[\"rotate\"+name+\"-\"+idx], tar = item[name] || 0,","\t\t\t\t\tcurmod = cur % 360, tarmod = tar % 360;","\t\t\t\tif(curmod < 0) {","\t\t\t\t\tcurmod += 360;","\t\t\t\t}","\t\t\t\tif(tarmod < 0) {","\t\t\t\t\ttarmod += 360;","\t\t\t\t}","\t\t\t\tvar diff = tarmod - curmod;","\t\t\t\tif(diff < -180) {","\t\t\t\t\tdiff += 360;","\t\t\t\t} else if(diff > 180) {","\t\t\t\t\tdiff -= 360;","\t\t\t\t}","\t\t\t\teventData.current[\"rotate\"+name+\"-\"+idx] = item[name] = cur + diff;","\t\t\t}","\t\t\tlowRotate(1);","\t\t\tlowRotate(2);","\t\t\tlowRotate(3);","\t\t});","\t});","\t$.jmpress(\"applyTarget\", function( active, eventData ) {","","\t\tvar target = eventData.target,","\t\t\tprops, step = eventData.stepData,","\t\t\tsettings = eventData.settings,","\t\t\tzoomin = target.perspectiveScale * 1.3 < eventData.current.perspectiveScale,","\t\t\tzoomout = target.perspectiveScale > eventData.current.perspectiveScale * 1.3;","","\t\t// extract first scale from transform","\t\tvar lastScale = -1;","\t\t$.each(target.transform, function(idx, item) {","\t\t\tif(item.length <= 1) {","\t\t\t\treturn;","\t\t\t}","\t\t\tif(item[0] === \"rotate\" &&","\t\t\t\titem[1] % 360 === 0  &&","\t\t\t\titem[2] % 360 === 0  &&","\t\t\t\titem[3] % 360 === 0) {","\t\t\t\treturn;","\t\t\t}","\t\t\tif(item[0] === \"scale\") {","\t\t\t\tlastScale = idx;","\t\t\t} else {","\t\t\t\treturn false;","\t\t\t}","\t\t});","","\t\tif(lastScale !== eventData.current.oldLastScale) {","\t\t\tzoomin = zoomout = false;","\t\t\teventData.current.oldLastScale = lastScale;","\t\t}","","\t\tvar extracted = [];","\t\tif(lastScale !== -1) {","\t\t\twhile(lastScale >= 0) {","\t\t\t\tif(target.transform[lastScale][0] === \"scale\") {","\t\t\t\t\textracted.push(target.transform[lastScale]);","\t\t\t\t\ttarget.transform[lastScale] = [\"scale\"];","\t\t\t\t}","\t\t\t\tlastScale--;","\t\t\t}","\t\t}","","\t\tvar animation = settings.animation;","\t\tif(settings.reasonableAnimation[eventData.reason]) {","\t\t\tanimation = $.extend({},","\t\t\t\tanimation,","\t\t\t\tsettings.reasonableAnimation[eventData.reason]);","\t\t}","","\t\tprops = {","\t\t\t// to keep the perspective look similar for different scales","\t\t\t// we need to 'scale' the perspective, too","\t\t\tperspective: Math.round(target.perspectiveScale * 1000) + \"px\"","\t\t};","\t\tprops = $.extend({}, animation, props);","\t\tif (!zoomin) {","\t\t\tprops.transitionDelay = '0s';","\t\t}","\t\tif (!eventData.beforeActive) {","\t\t\tprops.transitionDuration = '0s';","\t\t\tprops.transitionDelay = '0s';","\t\t}","\t\t$.jmpress(\"css\", eventData.area, props);","\t\tengine.transform(eventData.area, extracted);","","\t\tprops = $.extend({}, animation);","\t\tif (!zoomout) {","\t\t\tprops.transitionDelay = '0s';","\t\t}","\t\tif (!eventData.beforeActive) {","\t\t\tprops.transitionDuration = '0s';","\t\t\tprops.transitionDelay = '0s';","\t\t}","","\t\teventData.current.perspectiveScale = target.perspectiveScale;","","\t\t$.jmpress(\"css\", eventData.canvas, props);","\t\tengine.transform(eventData.canvas, target.transform);","\t});","","}(jQuery, document, window));","/*"," * active.js"," * Set the active classes on steps"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* DEFINES */","\tvar activeClass = 'activeClass',","\t\tnestedActiveClass = 'nestedActiveClass';","","\t/* DEFAULTS */","\tvar defaults = $jmpress( 'defaults' );","\tdefaults[nestedActiveClass] = \"nested-active\";","\tdefaults[activeClass]       = \"active\";","","\t/* HOOKS */","\t$jmpress( 'setInactive', function( step, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tactiveClassSetting = settings[activeClass],","\t\t\tnestedActiveClassSettings = settings[nestedActiveClass];","\t\tif(activeClassSetting) {","\t\t\t$(step).removeClass( activeClassSetting );","\t\t}","\t\tif(nestedActiveClassSettings) {","\t\t\t$.each(eventData.parents, function(idx, element) {","\t\t\t\t$(element).removeClass(nestedActiveClassSettings);","\t\t\t});","\t\t}","\t});","\t$jmpress( 'setActive', function( step, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tactiveClassSetting = settings[activeClass],","\t\t\tnestedActiveClassSettings = settings[nestedActiveClass];","\t\tif(activeClassSetting) {","\t\t\t$(step).addClass( activeClassSetting );","\t\t}","\t\tif(nestedActiveClassSettings) {","\t\t\t$.each(eventData.parents, function(idx, element) {","\t\t\t\t$(element).addClass(nestedActiveClassSettings);","\t\t\t});","\t\t}","\t});","","}(jQuery, document, window));","/*"," * circular.js"," * Repeat from start after end"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* FUNCTIONS */","\tfunction firstSlide( step, eventData ) {","\t\treturn $(this).find(eventData.settings.stepSelector).first();","\t}","\tfunction prevOrNext( jmpress, step, eventData, prev) {","\t\tif (!step) {","\t\t\treturn false;","\t\t}","\t\tvar stepSelector = eventData.settings.stepSelector;","\t\tstep = $(step);","\t\tdo {","\t\t\tvar item = step.near( stepSelector, prev );","\t\t\tif (item.length === 0 || item.closest(jmpress).length === 0) {","\t\t\t\titem = $(jmpress).find(stepSelector)[prev?\"last\":\"first\"]();","\t\t\t}","\t\t\tif (!item.length) {","\t\t\t\treturn false;","\t\t\t}","\t\t\tstep = item;","\t\t} while( step.data(\"stepData\").exclude );","\t\treturn step;","\t}","","\t/* HOOKS */","\t$jmpress( 'initStep', function( step, eventData ) {","\t\teventData.stepData.exclude = eventData.data.exclude && [\"false\", \"no\"].indexOf(eventData.data.exclude) === -1;","\t});","\t$jmpress( 'selectInitialStep', firstSlide);","\t$jmpress( 'selectHome', firstSlide);","\t$jmpress( 'selectEnd', function( step, eventData ) {","\t\treturn $(this).find(eventData.settings.stepSelector).last();","\t});","\t$jmpress( 'selectPrev', function( step, eventData ) {","\t\treturn prevOrNext(this, step, eventData, true);","\t});","\t$jmpress( 'selectNext', function( step, eventData ) {","\t\treturn prevOrNext(this, step, eventData);","\t});","}(jQuery, document, window));","/*"," * start.js"," * Set the first step to start on"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\t/* HOOKS */","\t$.jmpress( 'selectInitialStep', function( nil, eventData ) {","\t\treturn eventData.settings.start;","\t});","","}(jQuery, document, window));","/*"," * ways.js"," * Control the flow of the steps"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* FUNCTIONS */","\tfunction routeFunc( jmpress, route, type ) {","\t\tfor(var i = 0; i < route.length - 1; i++) {","\t\t\tvar from = route[i];","\t\t\tvar to = route[i+1];","\t\t\tif($(jmpress).jmpress(\"initialized\")) {","\t\t\t\t$(from, jmpress).data(\"stepData\")[type] = to;","\t\t\t} else {","\t\t\t\t$(from, jmpress).attr('data-' + type, to);","\t\t\t}","\t\t}","\t}","\tfunction selectPrevOrNext( step, eventData, attr, prev ) {","\t\tvar stepData = eventData.stepData;","\t\tif(stepData[attr]) {","\t\t\tvar near = $(step).near(stepData[attr], prev);","\t\t\tif(near && near.length) {","\t\t\t\treturn near;","\t\t\t}","\t\t\tnear = $(stepData[attr], this)[prev?\"last\":\"first\"]();","\t\t\tif(near && near.length) {","\t\t\t\treturn near;","\t\t\t}","\t\t}","\t}","","\t/* EXPORTED FUNCTIONS */","\t$jmpress( 'register', 'route', function( route, unidirectional, reversedRoute ) {","\t\tif( typeof route === \"string\" ) {","\t\t\troute = [route, route];","\t\t}","\t\trouteFunc(this, route, reversedRoute ? \"prev\" : \"next\");","\t\tif (!unidirectional) {","\t\t\trouteFunc(this, route.reverse(), reversedRoute ? \"next\" : \"prev\");","\t\t}","\t});","","\t/* HOOKS */","\t$jmpress( 'initStep', function( step, eventData ) {","\t\tfor(var attr in {next:1,prev:1}) {","\t\t\teventData.stepData[attr] = eventData.data[attr];","\t\t}","\t});","\t$jmpress( 'selectNext', function( step, eventData ) {","\t\treturn selectPrevOrNext.call(this, step, eventData, \"next\");","\t});","\t$jmpress( 'selectPrev', function( step, eventData ) {","\t\treturn selectPrevOrNext.call(this, step, eventData, \"prev\", true);","\t});","","}(jQuery, document, window));","/*"," * ajax.js"," * Load steps via ajax"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* DEFINES */","\tvar afterStepLoaded = 'ajax:afterStepLoaded',","\t\tloadStep = 'ajax:loadStep';","","\t/* REGISTER EVENTS */","\t$jmpress('register', loadStep);","\t$jmpress('register', afterStepLoaded);","","\t/* DEFAULTS */","\t$jmpress('defaults').ajaxLoadedClass = \"loaded\";","","\t/* HOOKS */","\t$jmpress('initStep', function( step, eventData ) {","\t\teventData.stepData.src = $(step).attr('href') || eventData.data.src || false;","\t\teventData.stepData.srcLoaded = false;","\t});","\t$jmpress(loadStep, function( step, eventData ) {","\t\tvar stepData = eventData.stepData,","\t\t\thref = stepData && stepData.src,","\t\t\tsettings = eventData.settings;","\t\tif ( href ) {","\t\t\t$(step).addClass( settings.ajaxLoadedClass );","\t\t\tstepData.srcLoaded = true;","\t\t\t$(step).load(href, function(response, status, xhr) {","\t\t\t\t$(eventData.jmpress).jmpress('fire', afterStepLoaded, step, $.extend({}, eventData, {","\t\t\t\t\tresponse: response","\t\t\t\t\t,status: status","\t\t\t\t\t,xhr: xhr","\t\t\t\t}));","\t\t\t});","\t\t}","\t});","\t$jmpress('idle', function( step, eventData ) {","\t\tif (!step) {","\t\t\treturn;","\t\t}","\t\tvar settings = eventData.settings,","\t\t\tjmpress = $(this),","\t\t\tstepData = eventData.stepData;","\t\tvar siblings = $(step)","\t\t\t.add( $(step).near( settings.stepSelector ) )","\t\t\t.add( $(step).near( settings.stepSelector, true) )","\t\t\t.add( jmpress.jmpress('fire', 'selectPrev', step, {","\t\t\t\tstepData: $(step).data('stepData')","\t\t\t}))","\t\t\t.add( jmpress.jmpress('fire', 'selectNext', step, {","\t\t\t\tstepData: $(step).data('stepData')","\t\t\t}));","\t\tsiblings.each(function() {","\t\t\tvar step = this,","\t\t\t\tstepData = $(step).data(\"stepData\");","\t\t\tif(!stepData.src || stepData.srcLoaded) {","\t\t\t\treturn;","\t\t\t}","\t\t\tjmpress.jmpress('fire', loadStep, step, {","\t\t\t\tstepData: $(step).data('stepData')","\t\t\t});","\t\t});","\t});","\t$jmpress(\"setActive\", function(step, eventData) {","\t\tvar stepData = $(step).data(\"stepData\");","\t\tif(!stepData.src || stepData.srcLoaded) {","\t\t\treturn;","\t\t}","\t\t$(this).jmpress('fire', loadStep, step, {","\t\t\tstepData: $(step).data('stepData')","\t\t});","\t});","","}(jQuery, document, window));","/*"," * hash.js"," * Detect and set the URL hash"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress,","\t\thashLink = \"a[href^=#]\";","","\t/* FUNCTIONS */","\tfunction randomString() {","\t\treturn \"\" + Math.round(Math.random() * 100000, 0);","\t}","\t/**","\t * getElementFromUrl","\t *","\t * @return String or undefined","\t */","\tfunction getElementFromUrl(settings) {","\t\t// get id from url # by removing `#` or `#/` from the beginning,","\t\t// so both \"fallback\" `#slide-id` and \"enhanced\" `#/slide-id` will work","\t\t// TODO SECURITY check user input to be valid!","\t\ttry {","\t\t\tvar el = $( '#' + window.location.hash.replace(/^#\\/?/,\"\") );","\t\t\treturn el.length > 0 && el.is(settings.stepSelector) ? el : undefined;","\t\t} catch(e) {}","\t}","\tfunction setHash(stepid) {","\t\tvar shouldBeHash = \"#/\" + stepid;","\t\tif(window.history && window.history.pushState) {","\t\t\t// shouldBeHash = \"#\" + stepid;","\t\t\t// consider this for future versions","\t\t\t//  it has currently issues, when startup with a link with hash (webkit)","\t\t\tif(window.location.hash !== shouldBeHash) {","\t\t\t\twindow.history.pushState({}, '', shouldBeHash);","\t\t\t}","\t\t} else {","\t\t\tif(window.location.hash !== shouldBeHash) {","\t\t\t\twindow.location.hash = shouldBeHash;","\t\t\t}","\t\t}","\t}","","\t/* DEFAULTS */","\t$jmpress('defaults').hash = {","\t\tuse: true","\t\t,update: true","\t\t,bindChange: true","\t\t// NOTICE: {use: true, update: false, bindChange: true}","\t\t// will cause a error after clicking on a link to the current step","\t};","","\t/* HOOKS */","\t$jmpress('selectInitialStep', function( step, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\thashSettings = settings.hash,","\t\t\tcurrent = eventData.current,","\t\t\tjmpress = $(this);","\t\teventData.current.hashNamespace = \".jmpress-\"+randomString();","\t\t// HASH CHANGE EVENT","\t\tif ( hashSettings.use ) {","\t\t\tif ( hashSettings.bindChange ) {","\t\t\t\t$(window).bind('hashchange'+current.hashNamespace, function(event) {","\t\t\t\t\tvar urlItem = getElementFromUrl(settings);","\t\t\t\t\tif ( jmpress.jmpress('initialized') ) {","\t\t\t\t\t\tjmpress.jmpress(\"scrollFix\");","\t\t\t\t\t}","\t\t\t\t\tif(urlItem && urlItem.length) {","\t\t\t\t\t\tif(urlItem.attr(\"id\") !== jmpress.jmpress(\"active\").attr(\"id\")) {","\t\t\t\t\t\t\tjmpress.jmpress('select', urlItem);","\t\t\t\t\t\t}","\t\t\t\t\t\tsetHash(urlItem.attr(\"id\"));","\t\t\t\t\t}","\t\t\t\t\tevent.preventDefault();","\t\t\t\t});","\t\t\t\t$(hashLink).on(\"click\"+current.hashNamespace, function(event) {","\t\t\t\t\tvar href = $(this).attr(\"href\");","\t\t\t\t\ttry {","\t\t\t\t\t\tif($(href).is(settings.stepSelector)) {","\t\t\t\t\t\t\tjmpress.jmpress(\"select\", href);","\t\t\t\t\t\t\tevent.preventDefault();","\t\t\t\t\t\t\tevent.stopPropagation();","\t\t\t\t\t\t}","\t\t\t\t\t} catch(e) {}","\t\t\t\t});","\t\t\t}","\t\t\treturn getElementFromUrl(settings);","\t\t}","\t});","\t$jmpress('afterDeinit', function( nil, eventData ) {","\t\t$(hashLink).off(eventData.current.hashNamespace);","\t\t$(window).unbind(eventData.current.hashNamespace);","\t});","\t$jmpress('setActive', function( step, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tcurrent = eventData.current;","\t\t// `#/step-id` is used instead of `#step-id` to prevent default browser","\t\t// scrolling to element in hash","\t\tif ( settings.hash.use && settings.hash.update ) {","\t\t\tclearTimeout(current.hashtimeout);","\t\t\tcurrent.hashtimeout = setTimeout(function() {","\t\t\t\tsetHash($(eventData.delegatedFrom).attr('id'));","\t\t\t}, settings.transitionDuration + 200);","\t\t}","\t});","","}(jQuery, document, window));","/*"," * keyboard.js"," * Keyboard event mapping and default keyboard actions"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress,","\t\tjmpressNext = \"next\",","\t\tjmpressPrev = \"prev\";","","\t/* FUNCTIONS */","\tfunction randomString() {","\t\treturn \"\" + Math.round(Math.random() * 100000, 0);","\t}","\tfunction stopEvent(event) {","\t\tevent.preventDefault();","\t\tevent.stopPropagation();","\t}","","\t/* DEFAULTS */","\t$jmpress('defaults').keyboard = {","\t\tuse: true","\t\t,keys: {","\t\t\t33: jmpressPrev // pg up","\t\t\t,37: jmpressPrev // left","\t\t\t,38: jmpressPrev // up","","\t\t\t,9: jmpressNext+\":\"+jmpressPrev // tab","\t\t\t,32: jmpressNext // space","\t\t\t,34: jmpressNext // pg down","\t\t\t,39: jmpressNext // right","\t\t\t,40: jmpressNext // down","","\t\t\t,36: \"home\" // home","","\t\t\t,35: \"end\" // end","\t\t}","\t\t,ignore: {","\t\t\t\"INPUT\": [","\t\t\t\t32 // space","\t\t\t\t,37 // left","\t\t\t\t,38 // up","\t\t\t\t,39 // right","\t\t\t\t,40 // down","\t\t\t]","\t\t\t,\"TEXTAREA\": [","\t\t\t\t32 // space","\t\t\t\t,37 // left","\t\t\t\t,38 // up","\t\t\t\t,39 // right","\t\t\t\t,40 // down","\t\t\t]","\t\t\t,\"SELECT\": [","\t\t\t\t38 // up","\t\t\t\t,40 // down","\t\t\t]","\t\t}","\t\t,tabSelector: \"a[href]:visible, :input:visible\"","\t};","","\t/* HOOKS */","\t$jmpress('afterInit', function( nil, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tkeyboardSettings = settings.keyboard,","\t\t\tignoreKeyboardSettings = keyboardSettings.ignore,","\t\t\tcurrent = eventData.current,","\t\t\tjmpress = $(this);","","\t\t// tabindex make it focusable so that it can recieve key events","\t\tif(!settings.fullscreen) {","\t\t\tjmpress.attr(\"tabindex\", 0);","\t\t}","","\t\tcurrent.keyboardNamespace = \".jmpress-\"+randomString();","","\t\t// KEYPRESS EVENT: this fixes a Opera bug","\t\t$(settings.fullscreen ? document : jmpress)","\t\t\t.bind(\"keypress\"+current.keyboardNamespace, function( event ) {","","\t\t\tfor( var nodeName in ignoreKeyboardSettings ) {","\t\t\t\tif ( event.target.nodeName === nodeName && ignoreKeyboardSettings[nodeName].indexOf(event.which) !== -1 ) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t}","\t\t\tif(event.which >= 37 && event.which <= 40 || event.which === 32) {","\t\t\t\tstopEvent(event);","\t\t\t}","\t\t});","\t\t// KEYDOWN EVENT","\t\t$(settings.fullscreen ? document : jmpress)","\t\t\t.bind(\"keydown\"+current.keyboardNamespace, function( event ) {","\t\t\tvar eventTarget = $(event.target);","","\t\t\tif ( !settings.fullscreen && !eventTarget.closest(jmpress).length || !keyboardSettings.use ) {","\t\t\t\treturn;","\t\t\t}","","\t\t\tfor( var nodeName in ignoreKeyboardSettings ) {","\t\t\t\tif ( eventTarget[0].nodeName === nodeName && ignoreKeyboardSettings[nodeName].indexOf(event.which) !== -1 ) {","\t\t\t\t\treturn;","\t\t\t\t}","\t\t\t}","","\t\t\tvar reverseSelect = false;","\t\t\tvar nextFocus;","\t\t\tif (event.which === 9) {","\t\t\t\t// tab","\t\t\t\tif ( !eventTarget.closest( jmpress.jmpress('active') ).length ) {","\t\t\t\t\tif ( !event.shiftKey ) {","\t\t\t\t\t\tnextFocus = jmpress.jmpress('active').find(\"a[href], :input\").filter(\":visible\").first();","\t\t\t\t\t} else {","\t\t\t\t\t\treverseSelect = true;","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\tnextFocus = eventTarget.near( keyboardSettings.tabSelector, event.shiftKey );","\t\t\t\t\tif( !$(nextFocus)","\t\t\t\t\t\t.closest( settings.stepSelector )","\t\t\t\t\t\t.is(jmpress.jmpress('active') ) ) {","\t\t\t\t\t\tnextFocus = undefined;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tif( nextFocus && nextFocus.length > 0 ) {","\t\t\t\t\tnextFocus.focus();","\t\t\t\t\tjmpress.jmpress(\"scrollFix\");","\t\t\t\t\tstopEvent(event);","\t\t\t\t\treturn;","\t\t\t\t} else {","\t\t\t\t\tif(event.shiftKey) {","\t\t\t\t\t\treverseSelect = true;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tvar action = keyboardSettings.keys[ event.which ];","\t\t\tif ( typeof action === \"string\" ) {","\t\t\t\tif (action.indexOf(\":\") !== -1) {","\t\t\t\t\taction = action.split(\":\");","\t\t\t\t\taction = event.shiftKey ? action[1] : action[0];","\t\t\t\t}","\t\t\t\tjmpress.jmpress( action );","\t\t\t\tstopEvent(event);","\t\t\t} else if ( $.isFunction(action) ) {","\t\t\t\taction.call(jmpress, event);","\t\t\t} else if ( action ) {","\t\t\t\tjmpress.jmpress.apply( jmpress, action );","\t\t\t\tstopEvent(event);","\t\t\t}","","\t\t\tif (reverseSelect) {","\t\t\t\t// tab","\t\t\t\tnextFocus = jmpress.jmpress('active').find(\"a[href], :input\").filter(\":visible\").last();","\t\t\t\tnextFocus.focus();","\t\t\t\tjmpress.jmpress(\"scrollFix\");","\t\t\t}","\t\t});","\t});","\t$jmpress('afterDeinit', function( nil, eventData ) {","\t\t$(document).unbind(eventData.current.keyboardNamespace);","\t});","","","}(jQuery, document, window));","/*"," * viewport.js"," * Scale to fit a given viewport"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\tfunction randomString() {","\t\treturn \"\" + Math.round(Math.random() * 100000, 0);","\t}","","\tvar browser = (function() {","\t\tvar ua = navigator.userAgent.toLowerCase();","\t\tvar match = /(chrome)[ \\/]([\\w.]+)/.exec(ua) ||","\t\t\t/(webkit)[ \\/]([\\w.]+)/.exec(ua) ||","\t\t\t/(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) ||","\t\t\t/(msie) ([\\w.]+)/.exec(ua) ||","\t\t\tua.indexOf(\"compatible\") < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua) ||","\t\t\t[];","\t\treturn match[1] || \"\";","\t}());","","\tvar defaults = $.jmpress(\"defaults\");","\tdefaults.viewPort = {","\t\twidth: false","\t\t,height: false","\t\t,maxScale: 0","\t\t,minScale: 0","\t\t,zoomable: 0","\t\t,zoomBindMove: true","\t\t,zoomBindWheel: true","\t};","\tvar keys = defaults.keyboard.keys;","\tkeys[browser === 'mozilla' ? 107 : 187] = \"zoomIn\";  // +","\tkeys[browser === 'mozilla' ? 109 : 189] = \"zoomOut\"; // -","\tdefaults.reasonableAnimation.resize = {","\t\ttransitionDuration: '0s'","\t\t,transitionDelay: '0ms'","\t};","\tdefaults.reasonableAnimation.zoom = {","\t\ttransitionDuration: '0s'","\t\t,transitionDelay: '0ms'","\t};","\t$.jmpress(\"initStep\", function( step, eventData ) {","\t\tfor(var variable in {\"viewPortHeight\":1, \"viewPortWidth\":1, \"viewPortMinScale\":1, \"viewPortMaxScale\":1, \"viewPortZoomable\":1}) {","\t\t\teventData.stepData[variable] = eventData.data[variable] && parseFloat(eventData.data[variable]);","\t\t}","\t});","\t$.jmpress(\"afterInit\", function( nil, eventData ) {","\t\tvar jmpress = this;","\t\teventData.current.viewPortNamespace = \".jmpress-\"+randomString();","\t\t$(window).bind(\"resize\"+eventData.current.viewPortNamespace, function (event) {","\t\t\t$(jmpress).jmpress(\"reselect\", \"resize\");","\t\t});","\t\teventData.current.userZoom = 0;","\t\teventData.current.userTranslateX = 0;","\t\teventData.current.userTranslateY = 0;","\t\tif(eventData.settings.viewPort.zoomBindWheel) {","\t\t\t$(eventData.settings.fullscreen ? document : this)","\t\t\t\t.bind(\"mousewheel\"+eventData.current.viewPortNamespace+\" DOMMouseScroll\"+eventData.current.viewPortNamespace, function( event, delta ) {","\t\t\t\tdelta = delta || event.originalEvent.wheelDelta || -event.originalEvent.detail /* mozilla */;","\t\t\t\tvar direction = (delta / Math.abs(delta));","\t\t\t\tif(direction < 0) {","\t\t\t\t\t$(eventData.jmpress).jmpress(\"zoomOut\", event.originalEvent.x, event.originalEvent.y);","\t\t\t\t} else if(direction > 0) {","\t\t\t\t\t$(eventData.jmpress).jmpress(\"zoomIn\", event.originalEvent.x, event.originalEvent.y);","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t});","\t\t}","\t\tif(eventData.settings.viewPort.zoomBindMove) {","\t\t\t$(eventData.settings.fullscreen ? document : this).bind(\"mousedown\"+eventData.current.viewPortNamespace, function (event) {","\t\t\t\tif(eventData.current.userZoom) {","\t\t\t\t\teventData.current.userTranslating = { x: event.clientX, y: event.clientY };","\t\t\t\t\tevent.preventDefault();","\t\t\t\t\tevent.stopImmediatePropagation();","\t\t\t\t}","\t\t\t}).bind(\"mousemove\"+eventData.current.viewPortNamespace, function (event) {","\t\t\t\tvar userTranslating = eventData.current.userTranslating;","\t\t\t\tif(userTranslating) {","\t\t\t\t\t$(jmpress).jmpress(\"zoomTranslate\", event.clientX - userTranslating.x, event.clientY - userTranslating.y);","\t\t\t\t\tuserTranslating.x = event.clientX;","\t\t\t\t\tuserTranslating.y = event.clientY;","\t\t\t\t\tevent.preventDefault();","\t\t\t\t\tevent.stopImmediatePropagation();","\t\t\t\t}","\t\t\t}).bind(\"mouseup\"+eventData.current.viewPortNamespace, function (event) {","\t\t\t\tif(eventData.current.userTranslating) {","\t\t\t\t\teventData.current.userTranslating = undefined;","\t\t\t\t\tevent.preventDefault();","\t\t\t\t\tevent.stopImmediatePropagation();","\t\t\t\t}","\t\t\t});","\t\t}","\t});","\tfunction maxAbs(value, range) {","\t\treturn Math.max(Math.min(value, range), -range);","\t}","\tfunction zoom(x, y, direction) {","\t\tvar current = $(this).jmpress(\"current\"),","\t\t\tsettings = $(this).jmpress(\"settings\"),","\t\t\tstepData = $(this).jmpress(\"active\").data(\"stepData\"),","\t\t\tcontainer = $(this).jmpress(\"container\");","\t\tif(current.userZoom === 0 && direction < 0) {","\t\t\treturn;","\t\t}","\t\tvar zoomableSteps = stepData.viewPortZoomable || settings.viewPort.zoomable;","\t\tif(current.userZoom === zoomableSteps && direction > 0) {","\t\t\treturn;","\t\t}","\t\tcurrent.userZoom += direction;","","\t\tvar halfWidth = $(container).innerWidth()/2,","\t\t\thalfHeight = $(container).innerHeight()/2;","","\t\tx = x ? x - halfWidth : x;","\t\ty = y ? y - halfHeight : y;","","\t\t// TODO this is not perfect... too much math... :(","\t\tcurrent.userTranslateX =","\t\t\tmaxAbs(current.userTranslateX - direction * x / current.zoomOriginWindowScale / zoomableSteps,","\t\t\thalfWidth * current.userZoom * current.userZoom / zoomableSteps);","\t\tcurrent.userTranslateY =","\t\t\tmaxAbs(current.userTranslateY - direction * y / current.zoomOriginWindowScale / zoomableSteps,","\t\t\thalfHeight * current.userZoom * current.userZoom / zoomableSteps);","","\t\t$(this).jmpress(\"reselect\", \"zoom\");","\t}","\t$.jmpress(\"register\", \"zoomIn\", function(x, y) {","\t\tzoom.call(this, x||0, y||0, 1);","\t});","\t$.jmpress(\"register\", \"zoomOut\", function(x, y) {","\t\tzoom.call(this, x||0, y||0, -1);","\t});","\t$.jmpress(\"register\", \"zoomTranslate\", function(x, y) {","\t\tvar current = $(this).jmpress(\"current\"),","\t\t\tsettings = $(this).jmpress(\"settings\"),","\t\t\tstepData = $(this).jmpress(\"active\").data(\"stepData\"),","\t\t\tcontainer = $(this).jmpress(\"container\");","\t\tvar zoomableSteps = stepData.viewPortZoomable || settings.viewPort.zoomable;","\t\tvar halfWidth = $(container).innerWidth(),","\t\t\thalfHeight = $(container).innerHeight();","\t\tcurrent.userTranslateX =","\t\t\tmaxAbs(current.userTranslateX + x / current.zoomOriginWindowScale,","\t\t\thalfWidth * current.userZoom * current.userZoom / zoomableSteps);","\t\tcurrent.userTranslateY =","\t\t\tmaxAbs(current.userTranslateY + y / current.zoomOriginWindowScale,","\t\t\thalfHeight * current.userZoom * current.userZoom / zoomableSteps);","\t\t$(this).jmpress(\"reselect\", \"zoom\");","\t});","\t$.jmpress('afterDeinit', function( nil, eventData ) {","\t\t$(eventData.settings.fullscreen ? document : this).unbind(eventData.current.viewPortNamespace);","\t\t$(window).unbind(eventData.current.viewPortNamespace);","\t});","\t$.jmpress(\"setActive\", function( step, eventData ) {","\t\tvar viewPort = eventData.settings.viewPort;","\t\tvar viewPortHeight = eventData.stepData.viewPortHeight || viewPort.height;","\t\tvar viewPortWidth = eventData.stepData.viewPortWidth || viewPort.width;","\t\tvar viewPortMaxScale = eventData.stepData.viewPortMaxScale || viewPort.maxScale;","\t\tvar viewPortMinScale = eventData.stepData.viewPortMinScale || viewPort.minScale;","\t\t// Correct the scale based on the window's size","\t\tvar windowScaleY = viewPortHeight && $(eventData.container).innerHeight()/viewPortHeight;","\t\tvar windowScaleX = viewPortWidth && $(eventData.container).innerWidth()/viewPortWidth;","\t\tvar windowScale = (windowScaleX || windowScaleY) && Math.min( windowScaleX || windowScaleY, windowScaleY || windowScaleX );","","\t\tif(windowScale) {","\t\t\twindowScale = windowScale || 1;","\t\t\tif(viewPortMaxScale) {","\t\t\t\twindowScale = Math.min(windowScale, viewPortMaxScale);","\t\t\t}","\t\t\tif(viewPortMinScale) {","\t\t\t\twindowScale = Math.max(windowScale, viewPortMinScale);","\t\t\t}","","\t\t\tvar zoomableSteps = eventData.stepData.viewPortZoomable || eventData.settings.viewPort.zoomable;","\t\t\tif(zoomableSteps) {","\t\t\t\tvar diff = (1/windowScale) - (1/viewPortMaxScale);","\t\t\t\tdiff /= zoomableSteps;","\t\t\t\twindowScale = 1/((1/windowScale) - diff * eventData.current.userZoom);","\t\t\t}","","\t\t\teventData.target.transform.reverse();","\t\t\tif(eventData.current.userTranslateX && eventData.current.userTranslateY) {","\t\t\t\teventData.target.transform.push([\"translate\", eventData.current.userTranslateX, eventData.current.userTranslateY, 0]);","\t\t\t} else {","\t\t\t\teventData.target.transform.push([\"translate\"]);","\t\t\t}","\t\t\teventData.target.transform.push([\"scale\",","\t\t\t\twindowScale,","\t\t\t\twindowScale,","\t\t\t\t1]);","\t\t\teventData.target.transform.reverse();","\t\t\teventData.target.perspectiveScale /= windowScale;","\t\t}","\t\teventData.current.zoomOriginWindowScale = windowScale;","\t});","\t$.jmpress(\"setInactive\", function( step, eventData ) {","\t\tif(!eventData.nextStep || !step || $(eventData.nextStep).attr(\"id\") !== $(step).attr(\"id\")) {","\t\t\teventData.current.userZoom = 0;","\t\t\teventData.current.userTranslateX = 0;","\t\t\teventData.current.userTranslateY = 0;","\t\t}","\t});","","}(jQuery, document, window));","","/*"," * mouse.js"," * Clicking to select a step"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* FUNCTIONS */","\tfunction randomString() {","\t\treturn \"\" + Math.round(Math.random() * 100000, 0);","\t}","","\t/* DEFAULTS */","\t$jmpress(\"defaults\").mouse = {","\t\tclickSelects: true","\t};","","\t/* HOOKS */","\t$jmpress(\"afterInit\", function( nil, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tstepSelector = settings.stepSelector,","\t\t\tcurrent = eventData.current,","\t\t\tjmpress = $(this);","\t\tcurrent.clickableStepsNamespace = \".jmpress-\"+randomString();","\t\tjmpress.bind(\"click\"+current.clickableStepsNamespace, function(event) {","\t\t\tif (!settings.mouse.clickSelects || current.userZoom) {","\t\t\t\treturn;","\t\t\t}","","\t\t\t// get clicked step","\t\t\tvar clickedStep = $(event.target).closest(stepSelector);","","\t\t\t// clicks on the active step do default","\t\t\tif ( clickedStep.is( jmpress.jmpress(\"active\") ) ) {","\t\t\t\treturn;","\t\t\t}","","\t\t\tif (clickedStep.length) {","\t\t\t\t// select the clicked step","\t\t\t\tjmpress.jmpress(\"select\", clickedStep[0], \"click\");","\t\t\t\tevent.preventDefault();","\t\t\t\tevent.stopPropagation();","\t\t\t}","\t\t});","\t});","\t$jmpress('afterDeinit', function( nil, eventData ) {","\t\t$(this).unbind(eventData.current.clickableStepsNamespace);","\t});","","}(jQuery, document, window));","/*"," * mobile.js"," * Adds support for swipe on touch supported browsers"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress;","","\t/* FUNCTIONS */","\tfunction randomString() {","\t\treturn \"\" + Math.round(Math.random() * 100000, 0);","\t}","","\t/* HOOKS */","\t$jmpress( 'afterInit', function( step, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tcurrent = eventData.current,","\t\t\tjmpress = eventData.jmpress;","\t\tcurrent.mobileNamespace = \".jmpress-\"+randomString();","\t\tvar data, start = [0,0];","\t\t$(settings.fullscreen ? document : jmpress)","\t\t\t.bind(\"touchstart\"+current.mobileNamespace, function( event ) {","","\t\t\tdata = event.originalEvent.touches[0];","\t\t\tstart = [ data.pageX, data.pageY ];","","\t\t}).bind(\"touchmove\"+current.mobileNamespace, function( event ) {","\t\t\tdata = event.originalEvent.touches[0];","\t\t\tevent.preventDefault();","\t\t\treturn false;","\t\t}).bind(\"touchend\"+current.mobileNamespace, function( event ) {","\t\t\tvar end = [ data.pageX, data.pageY ],","\t\t\t\tdiff = [ end[0]-start[0], end[1]-start[1] ];","","\t\t\tif(Math.max(Math.abs(diff[0]), Math.abs(diff[1])) > 50) {","\t\t\t\tdiff = Math.abs(diff[0]) > Math.abs(diff[1]) ? diff[0] : diff[1];","\t\t\t\t$(jmpress).jmpress(diff > 0 ? \"prev\" : \"next\");","\t\t\t\tevent.preventDefault();","\t\t\t\treturn false;","\t\t\t}","\t\t});","\t});","\t$jmpress('afterDeinit', function( nil, eventData ) {","\t\tvar settings = eventData.settings,","\t\t\tcurrent = eventData.current,","\t\t\tjmpress = eventData.jmpress;","\t\t$(settings.fullscreen ? document : jmpress).unbind(current.mobileNamespace);","\t});","","}(jQuery, document, window));","/*"," * templates.js"," * The amazing template engine"," */","(function( $, document, window, undefined ) {","","\t'use strict';","\tvar $jmpress = $.jmpress,","\t\ttemplateFromParentIdent = \"_template_\",","\t\ttemplateFromApplyIdent = \"_applied_template_\";","","\t/* STATIC VARS */","\tvar templates = {};","","\t/* FUNCTIONS */","\tfunction addUndefined( target, values, prefix ) {","\t\tfor( var name in values ) {","\t\t\tvar targetName = name;","\t\t\tif ( prefix ) {","\t\t\t\ttargetName = prefix + targetName.substr(0, 1).toUpperCase() + targetName.substr(1);","\t\t\t}","\t\t\tif ( $.isPlainObject(values[name]) ) {","\t\t\t\taddUndefined( target, values[name], targetName );","\t\t\t} else if( target[targetName] === undefined ) {","\t\t\t\ttarget[targetName] = values[name];","\t\t\t}","\t\t}","\t}","\tfunction applyChildrenTemplates( children, templateChildren ) {","\t\tif ($.isArray(templateChildren)) {","\t\t\tif (templateChildren.length < children.length) {","\t\t\t\t$.error(\"more nested steps than children in template\");","\t\t\t} else {","\t\t\t\tchildren.each(function(idx, child) {","\t\t\t\t\tchild = $(child);","\t\t\t\t\tvar tmpl = child.data(templateFromParentIdent) || {};","\t\t\t\t\taddUndefined(tmpl, templateChildren[idx]);","\t\t\t\t\tchild.data(templateFromParentIdent, tmpl);","\t\t\t\t});","\t\t\t}","\t\t} else if($.isFunction(templateChildren)) {","\t\t\tchildren.each(function(idx, child) {","\t\t\t\tchild = $(child);","\t\t\t\tvar tmpl = child.data(templateFromParentIdent) || {};","\t\t\t\taddUndefined(tmpl, templateChildren(idx, child, children));","\t\t\t\tchild.data(templateFromParentIdent, tmpl);","\t\t\t});","\t\t} // TODO: else if(object)","\t}","\tfunction applyTemplate( data, element, template, eventData ) {","\t\tif (template.children) {","\t\t\tvar children = element.children( eventData.settings.stepSelector );","\t\t\tapplyChildrenTemplates( children, template.children );","\t\t}","\t\tapplyTemplateData( data, template );","\t}","\tfunction applyTemplateData( data, template ) {","\t\taddUndefined(data, template);","\t}","","\t/* HOOKS */","\t$jmpress(\"beforeInitStep\", function( step, eventData ) {","\t\tstep = $(step);","\t\tvar data = eventData.data,","\t\t\ttemplateFromAttr = data.template,","\t\t\ttemplateFromApply = step.data(templateFromApplyIdent),","\t\t\ttemplateFromParent = step.data(templateFromParentIdent);","\t\tif(templateFromAttr) {","\t\t\t$.each(templateFromAttr.split(\" \"), function(idx, tmpl) {","\t\t\t\tvar template = templates[tmpl];","\t\t\t\tapplyTemplate( data, step, template, eventData );","\t\t\t});","\t\t}","\t\tif (templateFromApply) {","\t\t\tapplyTemplate( data, step, templateFromApply, eventData );","\t\t}","\t\tif (templateFromParent) {","\t\t\tapplyTemplate( data, step, templateFromParent, eventData );","\t\t\tstep.data(templateFromParentIdent, null);","\t\t\tif(templateFromParent.template) {","\t\t\t\t$.each(templateFromParent.template.split(\" \"), function(idx, tmpl) {","\t\t\t\t\tvar template = templates[tmpl];","\t\t\t\t\tapplyTemplate( data, step, template, eventData );","\t\t\t\t});","\t\t\t}","\t\t}","\t});","\t$jmpress(\"beforeInit\", function( nil, eventData ) {","\t\tvar data = $jmpress(\"dataset\", this),","\t\t\tdataTemplate = data.template,","\t\t\tstepSelector = eventData.settings.stepSelector;","\t\tif (dataTemplate) {","\t\t\tvar template = templates[dataTemplate];","\t\t\tapplyChildrenTemplates( $(this).find(stepSelector).filter(function() {","\t\t\t\treturn !$(this).parent().is(stepSelector);","\t\t\t}), template.children );","\t\t}","\t});","","\t/* EXPORTED FUNCTIONS */","\t$jmpress(\"register\", \"template\", function( name, tmpl ) {","\t\tif (templates[name]) {","\t\t\ttemplates[name] = $.extend(true, {}, templates[name], tmpl);","\t\t} else {","\t\t\ttemplates[name] = $.extend(true, {}, tmpl);","\t\t}","\t});","\t$jmpress(\"register\", \"apply\", function( selector, tmpl ) {","\t\tif( !tmpl ) {","\t\t\t// TODO ERROR because settings not found","\t\t\tvar stepSelector = $(this).jmpress(\"settings\").stepSelector;","\t\t\tapplyChildrenTemplates( $(this).find(stepSelector).filter(function() {","\t\t\t\treturn !$(this).parent().is(stepSelector);","\t\t\t}), selector );","\t\t} else if($.isArray(tmpl)) {","\t\t\tapplyChildrenTemplates( $(selector), tmpl );","\t\t} else {","\t\t\tvar template;","\t\t\tif(typeof tmpl === \"string\") {","\t\t\t\ttemplate = templates[tmpl];","\t\t\t} else {","\t\t\t\ttemplate = $.extend(true, {}, tmpl);","\t\t\t}","\t\t\t$(selector).each(function(idx, element) {","\t\t\t\telement = $(element);","\t\t\t\tvar tmpl = element.data(templateFromApplyIdent) || {};","\t\t\t\taddUndefined(tmpl, template);","\t\t\t\telement.data(templateFromApplyIdent, tmpl);","\t\t\t});","\t\t}","\t});","","}(jQuery, document, window));","/*"," * jqevents.js"," * Fires jQuery events"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\t/* HOOKS */","\t// the events should not bubble up the tree","\t// elsewise nested jmpress would cause buggy behavior","\t$.jmpress(\"setActive\", function( step, eventData ) {","\t\tif(eventData.prevStep !== step) {","\t\t\t$(step).triggerHandler(\"enterStep\");","\t\t}","\t});","\t$.jmpress(\"setInactive\", function( step, eventData ) {","\t\tif(eventData.nextStep !== step) {","\t\t\t$(step).triggerHandler(\"leaveStep\");","\t\t}","\t});","","}(jQuery, document, window));","/*"," * animation.js"," * Apply custom animations to steps"," */","(function( $, document, window, undefined ) {","","\t'use strict';","","\tfunction parseSubstepInfo(str) {","\t\tvar arr = str.split(\" \");","\t\tvar className = arr[0];","\t\tvar config = { willClass: \"will-\"+className, doClass: \"do-\"+className, hasClass: \"has-\"+className };","\t\tvar state = \"\";","\t\tfor(var i = 1; i < arr.length; i++) {","\t\t\tvar s = arr[i];","\t\t\tswitch(state) {","\t\t\tcase \"\":","\t\t\t\tif(s === \"after\") {","\t\t\t\t\tstate = \"after\";","\t\t\t\t} else {","\t\t\t\t\t$.warn(\"unknown keyword in '\"+str+\"'. '\"+s+\"' unknown.\");","\t\t\t\t}","\t\t\t\tbreak;","\t\t\tcase \"after\":","\t\t\t\tif(s.match(/^[1-9][0-9]*m?s?/)) {","\t\t\t\t\tvar value = parseFloat(s);","\t\t\t\t\tif(s.indexOf(\"ms\") !== -1) {","\t\t\t\t\t\tvalue *= 1;","\t\t\t\t\t} else if(s.indexOf(\"s\") !== -1) {","\t\t\t\t\t\tvalue *= 1000;","\t\t\t\t\t} else if(s.indexOf(\"m\") !== -1) {","\t\t\t\t\t\tvalue *= 60000;","\t\t\t\t\t}","\t\t\t\t\tconfig.delay = value;","\t\t\t\t} else {","\t\t\t\t\tconfig.after = Array.prototype.slice.call(arr, i).join(\" \");","\t\t\t\t\ti = arr.length;","\t\t\t\t}","\t\t\t}","\t\t}","\t\treturn config;","\t}","\tfunction find(array, selector, start, end) {","\t\tend = end || (array.length - 1);","\t\tstart = start || 0;","\t\tfor(var i = start; i < end + 1; i++) {","\t\t\tif($(array[i].element).is(selector)) {","\t\t\t\treturn i;","\t\t\t}","\t\t}","\t}","\tfunction addOn(list, substep, delay) {","\t\t$.each(substep._on, function(idx, child) {","\t\t\tlist.push({substep: child.substep, delay: child.delay + delay});","\t\t\taddOn(list, child.substep, child.delay + delay);","\t\t});","\t}","\t$.jmpress(\"defaults\").customAnimationDataAttribute = \"jmpress\";","\t$.jmpress(\"afterInit\", function( nil, eventData ) {","\t\teventData.current.animationTimeouts = [];","\t\teventData.current.animationCleanupWaiting = [];","\t});","\t$.jmpress(\"applyStep\", function( step, eventData ) {","\t\t// read custom animation from elements","\t\tvar substepsData = {};","\t\tvar listOfSubsteps = [];","\t\t$(step).find(\"[data-\"+eventData.settings.customAnimationDataAttribute+\"]\")","\t\t\t\t.each(function(idx, element) {","\t\t\tif($(element).closest(eventData.settings.stepSelector).is(step)) {","\t\t\t\tlistOfSubsteps.push({element: element});","\t\t\t}","\t\t});","\t\tif(listOfSubsteps.length === 0) {","\t\t\treturn;","\t\t}","\t\t$.each(listOfSubsteps, function(idx, substep) {","\t\t\tsubstep.info = parseSubstepInfo(","\t\t\t\t$(substep.element).data(eventData.settings.customAnimationDataAttribute));","\t\t\t$(substep.element).addClass(substep.info.willClass);","\t\t\tsubstep._on = [];","\t\t\tsubstep._after = null;","\t\t});","\t\tvar current = {_after: undefined, _on: [], info: {}}; // virtual zero step","\t\t$.each(listOfSubsteps, function(idx, substep) {","\t\t\tvar other = substep.info.after;","\t\t\tif(other) {","\t\t\t\tif(other === \"step\") {","\t\t\t\t\tother = current;","\t\t\t\t} else if(other === \"prev\") {","\t\t\t\t\tother = listOfSubsteps[idx-1];","\t\t\t\t} else {","\t\t\t\t\tvar index = find(listOfSubsteps, other, 0, idx - 1);","\t\t\t\t\tif(index === undefined) {","\t\t\t\t\t\tindex = find(listOfSubsteps, other);","\t\t\t\t\t}","\t\t\t\t\tother = (index === undefined || index === idx) ? listOfSubsteps[idx-1] : listOfSubsteps[index];","\t\t\t\t}","\t\t\t} else {","\t\t\t\tother = listOfSubsteps[idx-1];","\t\t\t}","\t\t\tif(other) {","\t\t\t\tif(!substep.info.delay) {","\t\t\t\t\tif(!other._after) {","\t\t\t\t\t\tother._after = substep;","\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t\tother = other._after;","\t\t\t\t}","\t\t\t\tother._on.push({substep: substep, delay: substep.info.delay || 0});","\t\t\t}","\t\t});","\t\tif(current._after === undefined && current._on.length === 0) {","\t\t\tvar startStep = find(listOfSubsteps, eventData.stepData.startSubstep) || 0;","\t\t\tcurrent._after = listOfSubsteps[startStep];","\t\t}","\t\tvar substepsInOrder = [];","\t\tfunction findNextFunc(idx, item) {","\t\t\tif(item.substep._after) {","\t\t\t\tcurrent = item.substep._after;","\t\t\t\treturn false;","\t\t\t}","\t\t}","\t\tdo {","\t\t\tvar substepList = [{substep: current, delay: 0}];","\t\t\taddOn(substepList, current, 0);","\t\t\tsubstepsInOrder.push(substepList);","\t\t\tcurrent = null;","\t\t\t$.each(substepList, findNextFunc);","\t\t} while(current);","\t\tsubstepsData.list = substepsInOrder;","\t\t$(step).data(\"substepsData\", substepsData);","\t});","\t$.jmpress(\"unapplyStep\", function( step, eventData ) {","\t\tvar substepsData = $(step).data(\"substepsData\");","\t\tif(substepsData) {","\t\t\t$.each(substepsData.list, function(idx, activeSubsteps) {","\t\t\t\t$.each(activeSubsteps, function(idx, substep) {","\t\t\t\t\tif(substep.substep.info.willClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.willClass);","\t\t\t\t\t}","\t\t\t\t\tif(substep.substep.info.hasClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.hasClass);","\t\t\t\t\t}","\t\t\t\t\tif(substep.substep.info.doClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);","\t\t\t\t\t}","\t\t\t\t});","\t\t\t});","\t\t}","\t});","\t$.jmpress(\"setActive\", function(step, eventData) {","\t\tvar substepsData = $(step).data(\"substepsData\");","\t\tif(!substepsData) {","\t\t\treturn;","\t\t}","\t\tif(eventData.substep === undefined) {","\t\t\teventData.substep =","\t\t\t\t(eventData.reason === \"prev\" ?","\t\t\t\t\tsubstepsData.list.length-1 :","\t\t\t\t\t0","\t\t\t\t);","\t\t}","\t\tvar substep = eventData.substep;","\t\t$.each(eventData.current.animationTimeouts, function(idx, timeout) {","\t\t\tclearTimeout(timeout);","\t\t});","\t\teventData.current.animationTimeouts = [];","\t\t$.each(substepsData.list, function(idx, activeSubsteps) {","\t\t\tvar applyHas = idx < substep;","\t\t\tvar applyDo = idx <= substep;","\t\t\t$.each(activeSubsteps, function(idx, substep) {","\t\t\t\tif(substep.substep.info.hasClass) {","\t\t\t\t\t$(substep.substep.element)[(applyHas?\"add\":\"remove\")+\"Class\"](substep.substep.info.hasClass);","\t\t\t\t}","\t\t\t\tfunction applyIt() {","\t\t\t\t\t$(substep.substep.element).addClass(substep.substep.info.doClass);","\t\t\t\t}","\t\t\t\tif(applyDo && !applyHas && substep.delay && eventData.reason !== \"prev\") {","\t\t\t\t\tif(substep.substep.info.doClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);","\t\t\t\t\t\teventData.current.animationTimeouts.push(setTimeout(applyIt, substep.delay));","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\tif(substep.substep.info.doClass) {","\t\t\t\t\t\t$(substep.substep.element)[(applyDo?\"add\":\"remove\")+\"Class\"](substep.substep.info.doClass);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","\t\t});","\t});","\t$.jmpress(\"setInactive\", function(step, eventData) {","\t\tif(eventData.nextStep === step) {","\t\t\treturn;","\t\t}","\t\tfunction cleanupAnimation( substepsData ) {","\t\t\t$.each(substepsData.list, function(idx, activeSubsteps) {","\t\t\t\t$.each(activeSubsteps, function(idx, substep) {","\t\t\t\t\tif(substep.substep.info.hasClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.hasClass);","\t\t\t\t\t}","\t\t\t\t\tif(substep.substep.info.doClass) {","\t\t\t\t\t\t$(substep.substep.element).removeClass(substep.substep.info.doClass);","\t\t\t\t\t}","\t\t\t\t});","\t\t\t});","\t\t}","\t\t$.each(eventData.current.animationCleanupWaiting, function(idx, item) {","\t\t\tcleanupAnimation(item);","\t\t});","\t\teventData.current.animationCleanupWaiting = [];","\t\tvar substepsData = $(step).data(\"substepsData\");","\t\tif(substepsData) {","\t\t\teventData.current.animationCleanupWaiting.push( substepsData );","\t\t}","\t});","\t$.jmpress(\"selectNext\", function( step, eventData ) {","\t\tif(eventData.substep === undefined) {","\t\t\treturn;","\t\t}","\t\tvar substepsData = $(step).data(\"substepsData\");","\t\tif(!substepsData) {","\t\t\treturn;","\t\t}","\t\tif(eventData.substep < substepsData.list.length-1) {","\t\t\treturn {step: step, substep: eventData.substep+1};","\t\t}","\t});","\t$.jmpress(\"selectPrev\", function( step, eventData ) {","\t\tif(eventData.substep === undefined) {","\t\t\treturn;","\t\t}","\t\tvar substepsData = $(step).data(\"substepsData\");","\t\tif(!substepsData) {","\t\t\treturn;","\t\t}","\t\tif(eventData.substep > 0) {","\t\t\treturn {step: step, substep: eventData.substep-1};","\t\t}","\t});","","}(jQuery, document, window));"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":22,"column":21},"end":{"row":22,"column":21},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1426169568132,"hash":"ab2f755c225cf74c0f16762135a68bcda27af5e6"}